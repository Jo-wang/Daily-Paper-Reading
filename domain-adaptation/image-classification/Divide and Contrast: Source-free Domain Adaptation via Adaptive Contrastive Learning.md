## [Divide and Contrast: Source-free Domain Adaptation via Adaptive Contrastive Learning](https://arxiv.org/abs/2211.06612)

NeurIPS2022

Ranking: 4

### Introduction and background
![1671061163262](https://user-images.githubusercontent.com/46414159/207738654-bd07eb0f-f05f-4adb-b51d-8c28ce2b6c80.png)

- Global method mainly leverage self-supervised pseudo-labeling to achieve class-wise global alignment (sensitive to noisy labels)
- local method rely on local structure extraction that encourages the feature consistency among neighborhoods (suffers from the source bias)

- To solve these issue, the author proposes Divide and Contrast (DaC), taking full advantage of both global and local structures, while sidestepping their limitations.
### Method
![1671063908401](https://user-images.githubusercontent.com/46414159/207743916-05b21b3e-75a4-4bb2-b3bb-f642fb544760.png)
#### Data Segmentation and Self-Training
- ![1671064178331](https://user-images.githubusercontent.com/46414159/207744358-f1e4f708-3540-4504-b088-522b621373aa.png)
- ![1671064387160](https://user-images.githubusercontent.com/46414159/207744703-33f9e08d-ed99-4aa2-bbd8-85d53ba57264.png)
w and s means weak (random cropping and flipping) and strong (automatically learned augmentation strategy) augmentation
- Use threshold of the data is source-like. If not source-like, this data will become target specific.

#### Adaptive Constrastive Learning
![1671066022809](https://user-images.githubusercontent.com/46414159/207747699-3555691d-dbf0-4c87-b77a-a4fcd279352f.png)
- Prototype Generation
  - for the source-like anchor, encourage contrastive learning to achieve class-wise adaptation by designating the positive prototype as class centroid
  - for the target specific anchor:  enhance the semantic consistency with the strongly augmented features and kN features. $k^{+}=1/k+1(f_{i}^{s}+\sum{z_{k}})$ (strong aug feature + k nearest feature)
- Memory bank
init source-like set by choose top 5% prediction in each class. The c-th class centroids $w_{c}$ is generated by the mean of all source-like features.   
#### Distribution Alignment
![1671067963545](https://user-images.githubusercontent.com/46414159/207751534-0f98fcf7-cd36-43b7-879f-afeb2cdc743c.png)

### Experiments
- dataset: office-home, VisDA-2017, DomainNet
### Notes
